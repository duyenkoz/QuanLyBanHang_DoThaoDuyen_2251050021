{% extends 'admin/layout_admin/base.html' %}
{% block title %}Quản lý người dùng{% endblock %}
{% block content %}
<div class="">
    <div class="table-wrapper">
        <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center py-4">
            <div class="d-block mb-4 mb-md-0">
                <nav aria-label="breadcrumb" class="d-none d-md-inline-block">
                    <ol class="breadcrumb breadcrumb-dark breadcrumb-transparent">
                        <!-- breadcrumb chinh lai sau -->
                        <li class="breadcrumb-item">
                            <a href="#">
                                <svg class="icon icon-xxs" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6">
                                    </path>
                                </svg>
                            </a>
                        </li>
                        <li class="breadcrumb-item active"><a href="#">{% if type == "STAFF" %} Nhân viên {%else%} Khách
                                hàng {%endif%}</a></li>
                    </ol>
                </nav>
                <h2 class="h4">Danh sách {% if type == "STAFF" %} Nhân viên {%else%} Khách hàng {%endif%}</h2>
                <p class="mb-0">Hiển thị danh sách {% if type == "STAFF" %} Nhân viên {%else%} Khách hàng {%endif%}</p>
            </div>
            <div class="btn-toolbar mb-2 mb-md-0">
                {% if request.path == '/admin/staff' %}
                <a href="" class="btn btn-sm btn-gray-800 d-inline-flex align-items-center" data-bs-toggle="modal"
                    data-bs-target="#addStaffModal">
                    <svg class="icon icon-xs me-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                    Thêm
                </a>
                <a href="" class="btn btn-sm btn-gray-800 d-inline-flex align-items-center ms-2 ms-lg-3"
                    data-bs-toggle="modal" data-bs-target="#addRoleModal">
                    <svg class="icon icon-xs me-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                    Thêm role
                </a>
                {% endif %}
            </div>
        </div>
        <div class="table-settings mb-4">
            <div class="row align-items-center justify-content-between">
                <div class="col col-md-6 col-lg-3 col-xl-4">
                    <div class="input-group me-2 me-lg-3 fmxw-400">
                        <span id="search-icon" class="input-group-text">
                            <svg class="icon icon-xs" x-description="Heroicon name: solid/search"
                                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"
                                aria-hidden="true">
                                <path fill-rule="evenodd"
                                    d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z"
                                    clip-rule="evenodd"></path>
                            </svg>
                        </span>
                        <input id="search-box" type="text" class="form-control" placeholder="Tìm kiếm"
                            value="{{ search }}" aria-label="Tìm kiếm" aria-describedby="search-icon">
                    </div>
                </div>
                <div class="col-4 col-md-2 col-xl-1 ps-md-0 text-end">
                    <div class="dropdown">
                        <button class="btn btn-link text-dark dropdown-toggle dropdown-toggle-split m-0 p-1"
                            data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <svg class="icon icon-sm" fill="currentColor" viewBox="0 0 20 20"
                                xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd"
                                    d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z"
                                    clip-rule="evenodd"></path>
                            </svg>
                            <span class="visually-hidden">Toggle Dropdown</span>
                        </button>
                        <div class="dropdown-menu dropdown-menu-xs dropdown-menu-end pb-0 dropdown-pageSize">
                            <span class="small ps-3 fw-bold text-dark">Hiển thị</span>
                            <a class="dropdown-item d-flex align-items-center fw-bold" href="#" data-value="10">
                                10
                            </a>
                            <a class="dropdown-item d-flex align-items-center fw-bold" href="#" data-value="20">20</a>
                            <a class="dropdown-item d-flex align-items-center fw-bold" href="#" data-value="30">30</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- TABLE -->
        <div class="card card-body border-0 shadow table-wrapper table-responsive">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th class="border-gray-200">ID</th>
                        <th class="border-gray-200">Tên người dùng</th>
                        <th class="border-gray-200">Số điện thoại</th>
                        <th class="border-gray-200">Email</th>
                        <th class="border-gray-200">Địa chỉ</th>
                        <th class="border-gray-200">Ngày tạo</th>
                        {% if type == "STAFF" %}
                        <th class="border-gray-200">Vai trò</th>
                        {% endif %}
                        {% if session.get('role') == 'admin' and type == 'STAFF' %}
                        <th class="border-gray-200">Action</th>
                        {% endif %}
                    </tr>
                </thead>
                <tbody id="userTableBody">
                    {% if accounts|length > 0 %}
                    {% for user in accounts %}
                    <tr>
                        {% if type == "STAFF" %}
                        <td><a href="#" class="fw-bold">{{ user.UserId }}</a></td>
                        {% elif type == "CUSTOMER" %}
                        <td><a href="#" class="fw-bold">{{ user.CustomerId }}</a></td>
                        {% endif %}

                        <td>{{ user.Name or "Chưa có dữ liệu" }}</td>
                        <td>{{ user.Phone }}</td>
                        <td>{{ user.Email or "Chưa có dữ liệu" }}</td>
                        <td>{{ user.Address or "Chưa có dữ liệu" }}</td>
                        <td>
                            {% if user.CreatedAt %}
                            {{ user.CreatedAt.strftime('%Y-%m-%d %H:%M') }}
                            {% else %}
                            Chưa có dữ liệu
                            {% endif %}
                        </td>

                        {% if type == "STAFF" %}
                        <td>{{ user.role.RoleName if user.role else "Chưa có dữ liệu" }}</td>
                        {% endif %}

                        {% if session.get('role') == 'admin' and type == "STAFF" %}
                        <td>
                            <button class="btn btn-sm btn-danger btn-delete-staff" data-id="{{ user.UserId }}"
                                data-phone="{{ user.Phone }}">
                                Xóa
                            </button>
                        </td>
                        {% endif %}
                    </tr>
                    {% endfor %}
                    {% else %}
                    <tr>
                        <td colspan="{% if session.get('role') == 'admin' and type == 'STAFF' %}8{% elif type == 'STAFF' %}7{% else %}6{% endif %}"
                            class="text-center text-muted">
                            Không có dữ liệu
                        </td>
                    </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Modal Thêm Staff -->
    <div class="modal fade" id="addStaffModal" tabindex="-1" aria-labelledby="addStaffModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">

                <div class="modal-header">
                    <h5 class="modal-title" id="addStaffModalLabel">Thêm nhân viên mới</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Đóng"></button>
                </div>

                <form id="addStaffForm" method="POST">
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="phone" class="form-label">Số điện thoại <span
                                    class="text-danger">(*)</span></label>
                            <input type="text" class="form-control" id="phone_input" name="phone" required>
                        </div>
                        <div class="mb-3">
                            <label for="password" class="form-label">Mật khẩu <span
                                    class="text-danger">(*)</span></label>
                            <input type="password" class="form-control" id="password_input" name="password" required>
                        </div>
                        <div class="mb-3">
                            <label for="role_select" class="form-label">Vai trò <span
                                    class="text-danger">(*)</span></label>
                            <select class="form-select" id="role_select" name="role_id" required>
                                <option value="" disabled selected>-- Chọn vai trò --</option>
                                {% for role in roles %}
                                <option value="{{ role.RoleId }}">{{ role.RoleName }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                        <button type="submit" class="btn btn-primary">Thêm</button>
                    </div>
                </form>

            </div>
        </div>
    </div>
    <!-- Modal xóa -->
    <div class="modal fade" id="confirmDeleteModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Xác nhận xóa nhân viên</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Đóng"></button>
                </div>
                <div class="modal-body">
                    <p>Bạn có chắc chắn muốn xóa nhân viên <strong id="staffPhone"></strong>?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button>
                    <button type="button" class="btn btn-danger" id="btnConfirmDelete">Xóa</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Thêm Role -->
    <div class="modal fade" id="addRoleModal" tabindex="-1" aria-labelledby="addRoleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-xl"><!-- dùng modal rộng -->
            <div class="modal-content">

                <div class="modal-header">
                    <h5 class="modal-title" id="addRoleModalLabel">Quản lý vai trò</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Đóng"></button>
                </div>

                <div class="modal-body">
                    <div class="row">
                        <!-- Form thêm role -->
                        <div class="col-md-4 border-end">
                            <form id="addRoleForm" method="POST">
                                <div class="mb-3">
                                    <label for="roleName" class="form-label">Tên vai trò <span
                                            class="text-danger">(*)</span></label>
                                    <input type="text" class="form-control" id="roleName" name="roleName" required>
                                </div>
                                <div class="mb-3">
                                    <label for="roleDesc" class="form-label">Mô tả</label>
                                    <textarea class="form-control" id="roleDesc" name="roleDesc" rows="3"></textarea>
                                </div>
                                <div class="text-end">
                                    <button id="btnRoleSubmit" type="submit" class="btn btn-primary">Thêm</button>
                                    <button id="btnRoleCancel" type="button"
                                        class="btn btn-secondary d-none">Huỷ</button>
                                </div>
                            </form>
                        </div>

                        <!-- Bảng danh sách role -->
                        <div class="col-md-8">
                            <div class="table-responsive">
                                <table class="table table-bordered table-hover align-middle">
                                    <thead class="table-light">
                                        <tr>
                                            <th>ID</th>
                                            <th>Tên role</th>
                                            <th>Mô tả</th>
                                            <th>Ngày tạo</th>
                                            <th>Trạng thái</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="roleTableBody">
                                        <!-- Render dữ liệu role từ backend -->
                                        {% for role in roles %}
                                        <tr id="role-row-{{ role.RoleId }}">
                                            <td>{{ role.RoleId }}</td>
                                            <td class="role-name">{{ role.RoleName }}</td>
                                            <td class="role-desc">{{ role.Description or "—" }}</td>
                                            <td class="role-created">{{ role.CreatedAt.strftime('%d/%m/%Y') if
                                                role.CreatedAt else '' }}</td>
                                            <td>
                                                <span
                                                    class="badge toggle-status {{ 'bg-success' if role.IsActive else 'bg-secondary' }}"
                                                    data-id="{{ role.RoleId }}" style="cursor:pointer;">
                                                    {{ 'Active' if role.IsActive else 'Inactive' }}
                                                </span>
                                            </td>
                                            <td>
                                                <button type="button" class="btn btn-sm btn-warning btn-edit-role"
                                                    data-id="{{ role.RoleId }}" data-name="{{ role.RoleName }}"
                                                    data-desc="{{ role.Description or '' }}">
                                                    Sửa
                                                </button>
                                            </td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- PHÂN TRANG -->
    <div class="pagination">
        <nav aria-label="Pagination">
            <ul class="pagination justify-content-center">
                <li class="page-item {% if currentPage == 1 %}disabled{% endif %}">
                    <a class="page-link" href="?pageIndex={{ currentPage - 1 }}&search={{ search }}">Trước</a>
                </li>

                {% for page in pagination %}
                {% if page == '...' %}
                <li class="page-item disabled"><span class="page-link">...</span></li>
                {% else %}
                <li class="page-item {% if page == currentPage %}active{% endif %}">
                    <a class="page-link" href="?pageIndex={{ page }}&search={{ search }}">{{ page }}</a>
                </li>
                {% endif %}
                {% endfor %}

                <li class="page-item {% if currentPage == totalPage %}disabled{% endif %}">
                    <a class="page-link" href="?pageIndex={{ currentPage + 1 }}&search={{ search }}">Sau</a>
                </li>
            </ul>
        </nav>
    </div>
</div>
</div>

<script>
    $(document).ready(function () {
        // Validate form thêm staff
        $('#addStaffForm').validate({
            rules: {
                phone: {
                    required: true,
                    digits: true,
                    minlength: 10,
                    maxlength: 10,
                },
                password: {
                    required: true,
                    minlength: 4,
                },
            },
            messages: {
                phone: {
                    required: "Vui lòng nhập số điện thoại",
                    digits: "Số điện thoại phải là số nguyên dương",
                    minlength: "Số điện thoại phải có 10 chữ số",
                    maxlength: "Số điện thoại không được quá 10 chữ số"
                },
                password: {
                    required: "Vui lòng nhập mật khẩu",
                    minlength: "Mật khẩu phải có ít nhất 4 ký tự"
                }
            },
            submitHandler: async function (form, e) {
                e.preventDefault();
                const phone = $('#phone_input').val().trim();
                const password = $('#password_input').val().trim();
                const role_id = $('#role_select').val();

                try {
                    const res = await fetch("/admin/api/staff/add", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ phone, password, role_id })
                    });
                    const data = await res.json();

                    if (res.ok && data.status === "success") {
                        $('#noDataRow').remove();

                        const tbody = $("#userTableBody");
                        const tr = $(`
                        <tr>
                            <td><a href="#" class="fw-bold">${data.staff.id}</a></td>
                            <td><span class="fw-normal text-muted">Chưa có dữ liệu</span></td>
                            <td><span class="fw-normal">${data.staff.phone}</span></td>
                            <td><span class="fw-normal text-muted">Chưa có dữ liệu</span></td>
                            <td><span class="fw-normal text-muted">Chưa có dữ liệu</span></td>
                            <td><span class="fw-normal">${data.staff.created_at || "Chưa có dữ liệu"}</span></td>
                            <td><span class="fw-normal">${data.staff.role.RoleName}</span></td>
                            {% if session.get('role') == 'admin' %}
                            <td>
                                <button class="btn btn-sm btn-danger btn-delete-staff" data-id="${data.staff.id}"
                                    data-phone="${data.staff.phone}">
                                    Xóa
                                </button>
                            </td>
                            {% endif %}
                        </tr>
                    `);
                        tbody.prepend(tr);

                        form.reset();
                        const modalEl = document.getElementById("addStaffModal");
                        const modal = bootstrap.Modal.getInstance(modalEl) || new bootstrap.Modal(modalEl);
                        modal.hide();

                        toastSuccess("Thêm nhân viên thành công!");
                    } else {
                        toastError(data.message || "Có lỗi xảy ra");
                    }
                } catch (err) {
                    console.error(err);
                    toastError("Không thể thêm nhân viên!");
                }
            }
        });

        // Delete staff
        $(document).on("click", ".btn-delete-staff", function () {
            const staffIdToDelete = $(this).data("id");
            const staffPhone = $(this).data("phone");

            $("#staffPhone").text(staffPhone);
            $("#confirmDeleteModal").data("staffId", staffIdToDelete);

            const confirmDeleteModal = bootstrap.Modal.getOrCreateInstance(
                document.getElementById("confirmDeleteModal")
            );
            confirmDeleteModal.show();

            $("#btnConfirmDelete").off("click").on("click", function () {
                if (!staffIdToDelete) return;

                fetch(`/admin/api/staff/delete/${staffIdToDelete}`, {
                    method: "DELETE"
                })
                    .then(res => res.json())
                    .then(data => {
                        if (data.status === "success") {
                            $(`.btn-delete-staff[data-id="${staffIdToDelete}"]`).closest("tr").remove();

                            if ($("#userTableBody tr").length === 0) {
                                $("#userTableBody").append(`
                                <tr id="noDataRow">
                                    <td colspan="{% if session.get('role') == 'admin' %}7{% else %}6{% endif %}"
                                        class="text-center text-muted">
                                        Không có dữ liệu
                                    </td>
                                </tr>
                            `);
                            }

                            confirmDeleteModal.hide();
                            toastSuccess("Xóa nhân viên thành công!");
                        } else {
                            toastError(data.message || "Có lỗi xảy ra");
                        }
                    })
                    .catch(() => toastError("Lỗi kết nối"));
            });
        });

        // Search
        var preSearchValue = "{{ search }}";
        $('#search-box').on('keydown', function (e) {
            var searchValue = $(this).val().trim();
            if (e.key === 'Enter' && searchValue !== preSearchValue) {
                e.preventDefault();
                var url = new URL(window.location.href);
                url.searchParams.set('search', searchValue);
                url.searchParams.set('pageIndex', 1);
                window.location.href = url.toString();
            }
        });

        $('#search-icon').on('click', function () {
            var searchValue = $('#search-box').val().trim();
            if (searchValue !== preSearchValue) {
                var url = new URL(window.location.href);
                url.searchParams.set('search', searchValue);
                url.searchParams.set('pageIndex', 1);
                window.location.href = url.toString();
            }
        });

        let editingRoleId = null;

        $(document).on("click", ".btn-edit-role", function () {
            editingRoleId = $(this).data("id");
            const name = $(this).data("name");
            const desc = $(this).data("desc");

            // Load vào form
            $("#roleName").val(name);
            $("#roleDesc").val(desc);

            // Đổi nút submit thành Sửa
            $("#btnRoleSubmit").text("Sửa").removeClass("btn-primary").addClass("btn-success");
            $("#btnRoleCancel").removeClass("d-none");
        });

        // Validate và submit form thêm role
        $('#addRoleForm').validate({
            rules: {
                roleName: { required: true, minlength: 2 },
                roleDesc: { maxlength: 255 }
            },
            messages: {
                roleName: {
                    required: "Vui lòng nhập tên vai trò",
                    minlength: "Tên vai trò phải có ít nhất 2 ký tự"
                },
                roleDesc: {
                    maxlength: "Mô tả không được quá 255 ký tự"
                }
            },
            submitHandler: async function (form, e) {
                e.preventDefault();
                const roleName = $('#roleName').val().trim();
                const roleDesc = $('#roleDesc').val().trim();

                try {
                    let url = "/admin/api/role/add";
                    let method = "POST";

                    // Nếu đang sửa
                    if (editingRoleId) {
                        url = `/admin/api/role/${editingRoleId}/update`;
                        method = "PUT";
                    }

                    const res = await fetch(url, {
                        method,
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ roleName, roleDesc })
                    });
                    const data = await res.json();

                    if (res.ok && data.status === "success") {
                        if (editingRoleId) {
                            // Cập nhật ngay hàng đang sửa
                            const row = $(`#role-row-${editingRoleId}`);
                            row.find(".role-name").text(data.role.RoleName);
                            row.find(".role-desc").text(data.role.Description || "—");

                            // Cập nhật luôn data-* cho nút Sửa
                            const editBtn = row.find(".btn-edit-role");
                            editBtn.data("name", data.role.RoleName);
                            editBtn.data("desc", data.role.Description || "");

                            toastSuccess("Cập nhật role thành công!");
                        } else {
                            // Thêm mới (như tui viết hôm qua)
                            const newRow = `
                        <tr id="role-row-${data.role.RoleId}">
                            <td>${data.role.RoleId}</td>
                            <td>${data.role.RoleName}</td>
                            <td>${data.role.Description || "—"}</td>
                            <td>${data.role.CreatedAt}</td>
                            <td>
                                <span class="badge toggle-status ${data.role.IsActive ? 'bg-success' : 'bg-secondary'}"
                                    data-id="${data.role.RoleId}" style="cursor:pointer;">
                                    ${data.role.IsActive ? "Active" : "Inactive"}
                                </span>
                            </td>
                            <td>
                                <button class="btn btn-sm btn-warning btn-edit-role" 
                                        data-id="${data.role.RoleId}" 
                                        data-name="${data.role.RoleName}" 
                                        data-desc="${data.role.Description || ''}">
                                    Sửa
                                </button>
                            </td>
                        </tr>
                    `;
                            $("#roleTableBody").prepend(newRow);
                            toastSuccess("Thêm role thành công!");
                        }

                        // Reset form và state
                        form.reset();
                        editingRoleId = null;
                        $("#btnRoleSubmit").text("Thêm").removeClass("btn-success").addClass("btn-primary");
                        $("#btnRoleCancel").addClass("d-none");
                    } else {
                        toastError(data.message || "Có lỗi xảy ra");
                    }
                } catch (err) {
                    console.error(err);
                    toastError("Không thể lưu role!");
                }
            }
        });
    });

    $(document).on("click", ".toggle-status", function () {
        const roleId = $(this).data("id");
        const $badge = $(this);

        $.ajax({
            url: `/admin/api/role/${roleId}/toggle`,
            type: "POST",
            success: function (res) {
                if (res.status === "success") {
                    if (res.role.IsActive) {
                        $badge
                            .removeClass("bg-secondary")
                            .addClass("bg-success")
                            .text("Active");
                    } else {
                        $badge
                            .removeClass("bg-success")
                            .addClass("bg-secondary")
                            .text("Inactive");
                    }
                } else {
                    alert(res.message);
                }
            },
            error: function (xhr) {
                alert("Lỗi: " + xhr.responseJSON?.message || "Không thể đổi trạng thái");
            }
        });
    });

    $("#btnRoleCancel").on("click", function () {
        $("#addRoleForm")[0].reset();   // reset input
        editingRoleId = null;          // xoá trạng thái sửa

        // Đổi lại nút submit về Thêm
        $("#btnRoleSubmit").text("Thêm")
            .removeClass("btn-success")
            .addClass("btn-primary");

        // Ẩn nút Huỷ
        $("#btnRoleCancel").addClass("d-none");
    });
</script>

{% endblock %}